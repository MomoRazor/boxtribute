#!/usr/bin/env bash
# Utility script to invoke front-end style checks in the front directory, or other
# tools in the repository using yarn
# Usage: ./invoke_yarn lint|format|graphql-types FILE [FILE...]

mode=$1
shift

# strip front/ prefix from all given filepaths (pre-commit generates them from the repository root)
files=("${@#front/}")

# TODO: move this to the pre-commit config. Otherwise people need to install yarn
if [[ "$mode" = "lint" ]]; then
    yarn run lint:fix "$@"
elif [[ "$mode" = "format" ]]; then
    yarn --cwd front run format:write-files "${files[@]}"
elif [[ "$mode" = "graphql-types" ]]; then
    yarn --cwd front run generate-graphql-ts-types
else
    echo "Unknown mode: $mode" >&2
    exit 1
fi
